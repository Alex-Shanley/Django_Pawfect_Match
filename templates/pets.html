{% extends "base.html" %}
{% load static %}

{% block title %} Pawfect Match {% endblock %}

{% block content %}

{% include 'hero.html' %}

<section class="pets-list">
  <h2>Available Pets</h2>

  <!-- Filter Form -->
  <form method="get" action="{% url 'pets:list_pets' %}" id="custom-pet-filter">
    <input type="text" name="name" placeholder="Name" value="{{ name|default:'' }}">
    <input type="text" name="age" placeholder="Age" value="{{ age|default:'' }}">
    <input type="text" name="breed" placeholder="Breed" value="{{ breed|default:'' }}">

    <select name="species">
      <option value="">All Species</option>
      {% for option in species_options %}
        <option value="{{ option }}" {% if selected_species == option %}selected{% endif %}>{{ option }}</option>
      {% endfor %}
    </select>

    <button type="submit">Filter</button>
    <a href="{% url 'pets:list_pets' %}" id="clear-filters">Clear Filters</a>
  </form>

  <!-- Pets Display -->
  <div class="pets-container">
    {% if pets %}
      {% for pet in pets %}
        <div class="pet-card">
          
{% if pet.img %}
    <img src="{{ pet.img.url }}" alt="{{ pet.name }}">

{% else %}
    <img src="{{ pet.img.url }}" alt="{{ pet.name }}">

{% endif %}
          
          <div class="card-content">
            <p class="species">{{ pet.species|upper }}</p>
            <h3>{{ pet.name }}</h3>
            <p><strong>Breed:</strong> {{ pet.breed }}</p>
            <p><strong>Age:</strong> {{ pet.age }} years old</p>

            <!-- Action Buttons -->
            <div class="card-actions">
              {% if user.is_authenticated %}
              <a href="{% url 'pets:edit_pet' pet.id %}" class="edit-btn">Edit</a>
              
              <form method="POST" action="{% url 'pets:delete_pet' pet.id %}" onsubmit="return confirm('Are you sure you want to delete this pet?');" style="display:inline;">
                

                {% csrf_token %}
                <button type="submit" class="delete-btn">Delete</button>

                {% endif %}

              </form>
            </div>
          </div>
        </div>
      {% endfor %}
    {% else %}
      <p>No pets available at the moment. Please check back later!</p>
    {% endif %}
  </div>
</section>

{% include 'dog-fact.html' %}
{% include 'form.html' %}

{% endblock %}
